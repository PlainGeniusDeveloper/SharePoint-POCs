$("#modalSaveButton").click(function () {
    // Clear existing options in both dropdowns
    $regionDropdown.empty();
    $countryDropdown.empty();

    // Collect checked checkboxes
    const checkedCheckboxes = $modalDropdownContainer.find("input[type='checkbox']:checked");

    // Set for storing unique region titles
    const uniqueRegions = new Set();

    // Create options for the country dropdown
    checkedCheckboxes.each(function () {
        const $checkbox = $(this);
        const countryId = $checkbox.data("country-id");
        const countryName = $checkbox.data("country-name");
        const regionTitle = $checkbox.data("region-title");

        // Add to unique regions set
        if (regionTitle) {
            uniqueRegions.add(regionTitle);
        }

        // Create and append option to country dropdown
        const $countryOption = $("<option>")
            .val(countryId)
            .text(countryName);
        $countryDropdown.append($countryOption);
    });

    // Create options for the region dropdown
    uniqueRegions.forEach(regionTitle => {
        const $regionOption = $("<option>")
            .val(regionTitle)
            .text(regionTitle);
        $regionDropdown.append($regionOption);
    });

    // Close modal and alert success
    alert("Selections saved and dropdowns updated!");
    $editModal.hide();
    $modalBackdrop.hide();
});
