// Save modal data back to dropdown
$("#modalSaveButton").click(function () {
    // Clear the existing options in the dropdowns
    $regionDropdown.empty();
    $countryDropdown.empty();

    // Get all checked regions and their countries
    const selectedRegions = new Set();
    const selectedCountries = [];

    $modalDropdownContainer.find("input[type='checkbox']:checked").each(function () {
        const countryId = $(this).data("country-id");
        const countryName = $(this).data("country-name");
        const regionId = data.countries.find(country => country.id === countryId).regionId;
        const regionName = data.regions.find(region => region.id === regionId).name;

        selectedRegions.add(regionId); // Add region
        selectedCountries.push({
            id: countryId,
            name: countryName,
            regionId: regionId,
        });
    });

    // Add regions to the region dropdown
    selectedRegions.forEach(regionId => {
        const region = data.regions.find(r => r.id === regionId);
        const $regionOption = $("<option>")
            .val(region.id)
            .text(region.name);
        $regionDropdown.append($regionOption);
    });

    // Add countries to the country dropdown
    selectedCountries.forEach(country => {
        const $countryOption = $("<option>")
            .val(country.id)
            .text(country.name);
        $countryDropdown.append($countryOption);
    });

    // Trigger change to update notes or related behavior
    $regionDropdown.trigger("change");

    alert("Selections saved and dropdowns updated!");
    $editModal.hide();
    $modalBackdrop.hide();
});
