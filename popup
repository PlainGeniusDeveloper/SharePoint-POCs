// popup.js
export function showApprovalPopup({ onSubmit, onCancel, showCancelButton = true }) {
  // Remove existing popup if any
  const existing = document.getElementById("approval-popup");
  if (existing) existing.remove();

  // Create popup container
  const popup = document.createElement("div");
  popup.id = "approval-popup";
  popup.style.position = "fixed";
  popup.style.top = "0";
  popup.style.left = "0";
  popup.style.width = "100vw";
  popup.style.height = "100vh";
  popup.style.background = "rgba(0, 0, 0, 0.5)";
  popup.style.display = "flex";
  popup.style.alignItems = "center";
  popup.style.justifyContent = "center";
  popup.style.zIndex = "9999";

  popup.innerHTML = `
    <div style="background: white; padding: 20px; border-radius: 10px; width: 300px;">
      <h3>Approve or Reject</h3>
      <label><input type="radio" name="action" value="approve"> Approve</label><br>
      <label><input type="radio" name="action" value="reject"> Reject</label><br><br>
      <textarea id="approval-comment" placeholder="Add a comment..." rows="3" style="width: 100%;"></textarea><br><br>
      <div style="text-align: right;">
        <button id="approval-submit">Submit</button>
        ${showCancelButton ? '<button id="approval-cancel">Cancel</button>' : ''}
      </div>
    </div>
  `;

  document.body.appendChild(popup);

  document.getElementById("approval-submit").onclick = () => {
    const selected = document.querySelector('input[name="action"]:checked');
    const comment = document.getElementById("approval-comment").value;
    if (!selected) {
      alert("Please select approve or reject.");
      return;
    }
    if (onSubmit) onSubmit(selected.value, comment);
    popup.remove();
  };

  if (showCancelButton) {
    document.getElementById("approval-cancel").onclick = () => {
      if (onCancel) onCancel();
      popup.remove();
    };
  }
}
